import pyarts3 as pyarts
import numpy as np

f = np.linspace(1e9, 1000e9, 101)

atm = pyarts.arts.AtmPoint()
atm.pressure = 1e4
atm.temperature = 250
atm["H2O"] = 5e-3
atm["O2"] = 0.21
atm["N2"] = 0.781

z = pyarts.arts.predef.get_n2_mpm93(f, atm)

z_ref = np.array([1.10010782e-12, 1.32780332e-10, 4.83336817e-10, 1.05168051e-09,
                  1.83641914e-09, 2.83592250e-09, 4.04836143e-09, 5.47173550e-09,
                  7.10389448e-09, 8.94255584e-09, 1.09853196e-08, 1.32296811e-08,
                  1.56730426e-08, 1.83127232e-08, 2.11459683e-08, 2.41699581e-08,
                  2.73818149e-08, 3.07786111e-08, 3.43573751e-08, 3.81150976e-08,
                  4.20487380e-08, 4.61552290e-08, 5.04314820e-08, 5.48743921e-08,
                  5.94808418e-08, 6.42477060e-08, 6.91718551e-08, 7.42501593e-08,
                  7.94794915e-08, 8.48567308e-08, 9.03787653e-08, 9.60424952e-08,
                  1.01844835e-07, 1.07782716e-07, 1.13853088e-07, 1.20052924e-07,
                  1.26379218e-07, 1.32828991e-07, 1.39399289e-07, 1.46087187e-07,
                  1.52889790e-07, 1.59804232e-07, 1.66827682e-07, 1.73957339e-07,
                  1.81190440e-07, 1.88524253e-07, 1.95956084e-07, 2.03483275e-07,
                  2.11103206e-07, 2.18813293e-07, 2.26610991e-07, 2.34493794e-07,
                  2.42459234e-07, 2.50504882e-07, 2.58628349e-07, 2.66827285e-07,
                  2.75099380e-07, 2.83442363e-07, 2.91854004e-07, 3.00332110e-07,
                  3.08874529e-07, 3.17479150e-07, 3.26143897e-07, 3.34866739e-07,
                  3.43645677e-07, 3.52478757e-07, 3.61364058e-07, 3.70299701e-07,
                  3.79283841e-07, 3.88314675e-07, 3.97390433e-07, 4.06509382e-07,
                  4.15669828e-07, 4.24870110e-07, 4.34108604e-07, 4.43383719e-07,
                  4.52693902e-07, 4.62037630e-07, 4.71413416e-07, 4.80819807e-07,
                  4.90255380e-07, 4.99718746e-07, 5.09208547e-07, 5.18723456e-07,
                  5.28262179e-07, 5.37823448e-07, 5.47406030e-07, 5.57008716e-07,
                  5.66630328e-07, 5.76269719e-07, 5.85925765e-07, 5.95597372e-07,
                  6.05283472e-07, 6.14983024e-07, 6.24695013e-07, 6.34418447e-07,
                  6.44152362e-07, 6.53895816e-07, 6.63647893e-07, 6.73407698e-07,
                  6.83174361e-07])

assert np.allclose(z, z_ref), "Error in N2-MPM93"
