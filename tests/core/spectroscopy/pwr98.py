import pyarts
import numpy as np

f = np.linspace(1e9, 1500e9, 101)

atm = pyarts.arts.AtmPoint()
atm.pressure = 1e4
atm.temperature = 250
atm["H2O"] = 5e-3
atm["O2"] = 0.21
atm["N2"] = 0.781

x = pyarts.arts.predef.get_h2o_pwr98(f, atm)
y = pyarts.arts.predef.get_o2_pwr98(f, atm)

x_ref = np.array([8.58845619e-11, 4.50362790e-08, 1.19095313e-07, 1.64635217e-07,
                  2.73030719e-07, 4.18228035e-07, 6.00040373e-07, 8.21863725e-07,
                  1.09215734e-06, 1.43454408e-06, 1.93967519e-06, 3.25517040e-06,
                  7.78954621e-05, 6.22115325e-06, 4.16960280e-06, 4.31589206e-06,
                  4.80792975e-06, 5.46722590e-06, 6.27963349e-06, 7.30612413e-06,
                  8.83417488e-06, 1.46255706e-05, 2.64825799e-05, 1.58933561e-05,
                  2.46753132e-05, 2.43975709e-04, 6.24146977e-05, 3.03859378e-05,
                  3.31004058e-05, 7.37023873e-05, 6.23032138e-04, 7.14314065e-05,
                  8.55333361e-05, 1.06543947e-04, 1.76947116e-04, 3.83590769e-04,
                  1.43497068e-03, 2.15181252e-01, 2.25713253e-03, 5.64105692e-04,
                  2.77382461e-04, 2.55359324e-04, 1.53361614e-04, 1.13457541e-04,
                  1.02916888e-04, 1.03807155e-04, 1.17670039e-04, 1.57317279e-04,
                  2.77874639e-04, 8.90928397e-04, 9.60549510e-02, 1.41771553e-03,
                  3.71045465e-04, 1.95168648e-04, 1.35295187e-04, 1.08151815e-04,
                  9.39514534e-05, 8.61394141e-05, 8.23764139e-05, 8.31404869e-05,
                  1.01784017e-04, 1.01183872e-02, 1.08912853e-04, 8.14470530e-05,
                  7.68584104e-05, 7.57093965e-05, 7.56797677e-05, 7.61801392e-05,
                  7.69942619e-05, 7.80222283e-05, 7.92099466e-05, 8.05246167e-05,
                  8.19447660e-05, 8.34553950e-05, 8.50452023e-05, 8.67058004e-05,
                  8.84326089e-05, 9.02194240e-05, 9.20610739e-05, 9.39541026e-05,
                  9.58960289e-05, 9.78859036e-05, 9.99198911e-05, 1.01996301e-04,
                  1.04113499e-04, 1.06270163e-04, 1.08465157e-04, 1.10697488e-04,
                  1.13102555e-04, 1.15560105e-04, 1.18050856e-04, 1.20574382e-04,
                  1.23130774e-04, 1.25719502e-04, 1.28339985e-04, 1.30991961e-04,
                  1.33675192e-04, 1.36389466e-04, 1.39134592e-04, 1.41910398e-04,
                  1.44716727e-04])

y_ref = np.array([2.40470087e-08, 3.31302140e-08, 7.66703678e-08, 3.90780094e-07,
                  3.90727474e-04, 3.64129501e-07, 1.18935005e-07, 1.41744506e-07,
                  3.42970590e-06, 7.89020360e-08, 3.29468580e-08, 2.06551867e-08,
                  1.50062732e-08, 1.17664733e-08, 9.69137378e-09, 8.28539107e-09,
                  7.31614458e-09, 6.66822016e-09, 6.29184107e-09, 6.18891963e-09,
                  6.42712311e-09, 7.20929355e-09, 9.16190585e-09, 1.52012801e-08,
                  7.51768291e-08, 9.67672996e-08, 4.49474699e-08, 1.17699890e-07,
                  2.61187565e-06, 3.91348681e-07, 8.80491325e-08, 7.07956887e-08,
                  4.39048218e-07, 2.85467159e-07, 4.85381571e-08, 2.40120746e-08,
                  1.61361746e-08, 1.24882227e-08, 1.05073269e-08, 9.38187347e-09,
                  8.80054298e-09, 8.65211180e-09, 8.94637230e-09, 9.82800838e-09,
                  1.17144057e-08, 1.58792985e-08, 2.80062199e-08, 1.20581854e-07,
                  4.26325929e-07, 7.28922933e-08, 1.28795280e-07, 9.34860077e-07,
                  1.52924505e-06, 1.67305391e-07, 9.62734860e-08, 3.25410352e-07,
                  6.01336711e-07, 6.80687526e-08, 3.08707695e-08, 1.96784312e-08,
                  1.44950536e-08, 1.15424425e-08, 9.64677590e-09, 8.33177438e-09,
                  7.36887490e-09, 6.63503103e-09, 6.05824078e-09, 5.59362538e-09,
                  5.21179393e-09, 4.89271705e-09, 4.62229065e-09, 4.39030655e-09,
                  4.18920157e-09, 4.01325797e-09, 3.85807641e-09, 3.72021903e-09,
                  3.59696205e-09, 3.48612065e-09, 3.38592279e-09, 3.29491667e-09,
                  3.21190191e-09, 3.13587766e-09, 3.06600303e-09, 3.00156645e-09,
                  2.94196189e-09, 2.88666999e-09, 2.83524321e-09, 2.78729383e-09,
                  2.74248431e-09, 2.70051944e-09, 2.66113991e-09, 2.62411702e-09,
                  2.58924830e-09, 2.55635386e-09, 2.52527330e-09, 2.49586317e-09,
                  2.46799476e-09, 2.44155229e-09, 2.41643128e-09, 2.39253721e-09,
                  2.36978440e-09])

assert np.allclose(x, x_ref), "Error in H2O-PWR98"
assert np.allclose(y, y_ref), "Error in O2-PWR98"
