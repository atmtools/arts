import pyarts3 as pyarts
import numpy as np

f = np.linspace(1e9, 1000e9, 101)

atm = pyarts.arts.AtmPoint()
atm.pressure = 1e4
atm.temperature = 250
atm["H2O"] = 5e-3
atm["O2"] = 0.21
atm["N2"] = 0.781

x = pyarts.arts.predef.get_h2o_pwr2022(f, atm)
y = pyarts.arts.predef.get_o2_pwr2022(f, atm)

x_ref = np.array([8.62475125e-11, 1.27425599e-08, 1.09555578e-06, 1.19303429e-07,
                  1.38752287e-07, 1.97321500e-07, 2.74402559e-07, 3.67747583e-07,
                  4.77215729e-07, 6.03381296e-07, 7.47432761e-07, 9.11493605e-07,
                  1.09950245e-06, 1.31947202e-06, 1.59001828e-06, 1.96331780e-06,
                  2.63542633e-06, 4.89643402e-06, 7.91409996e-05, 1.21914504e-05,
                  4.95979379e-06, 4.23098834e-06, 4.24686887e-06, 4.48447562e-06,
                  4.82946806e-06, 5.24859328e-06, 5.73364586e-06, 6.29018739e-06,
                  6.93849735e-06, 7.73065129e-06, 8.82984359e-06, 1.10844363e-05,
                  4.57156883e-05, 2.71557313e-05, 1.53764609e-05, 1.72369063e-05,
                  2.43790660e-05, 6.25161350e-05, 1.59926682e-02, 6.28133891e-05,
                  3.28352923e-05, 2.97245130e-05, 3.27617973e-05, 4.47734151e-05,
                  2.00246200e-04, 6.78137699e-04, 7.52553581e-05, 4.60033502e-04,
                  8.47878177e-05, 1.10021070e-04, 1.19420212e-04, 1.71398341e-04,
                  2.74947659e-04, 5.21461542e-04, 1.35878575e-03, 8.90876040e-03,
                  3.19030287e-02, 2.25666275e-03, 7.90255154e-04, 4.18891737e-04,
                  2.73544440e-04, 2.15293691e-04, 1.19816632e-02, 1.54218280e-04,
                  1.21231436e-04, 1.10026448e-04, 1.13941948e-04, 1.04320089e-04,
                  1.08934102e-04, 1.20397501e-04, 1.42797597e-04, 1.86659861e-04,
                  2.82189862e-04, 5.44305658e-04, 1.75722194e-03, 7.20019130e-02,
                  3.76827916e-03, 8.33397754e-04, 3.91061168e-04, 2.46125555e-04,
                  1.81484901e-04, 1.47562501e-04, 1.28052672e-04, 1.16337975e-04,
                  1.09369935e-04, 1.05795961e-04, 3.05090694e-04, 1.05293605e-04,
                  1.08576115e-04, 1.16586679e-04, 1.38613687e-04, 3.11168366e-04,
                  6.03785294e-04, 1.87462882e-04, 1.92421814e-04, 2.43856789e-04,
                  3.96458831e-04, 4.20585011e-02, 2.94339412e-03, 3.92932930e-02,
                  1.39724601e-03])


y_ref = np.array([2.35915936e-08, 2.76152656e-08, 4.08711639e-08, 7.61583137e-08,
                  1.94360246e-07, 1.34233843e-06, 3.69992914e-04, 8.10346038e-07,
                  2.28235808e-07, 1.27441415e-07, 1.17624423e-07, 3.09871517e-07,
                  3.39614076e-06, 1.20238653e-07, 4.53175521e-08, 2.67248645e-08,
                  1.87111965e-08, 1.42592901e-08, 1.14181031e-08, 9.44911695e-09,
                  8.01596895e-09, 6.95575237e-09, 6.26396933e-09, 9.57056130e-09,
                  5.84871509e-09, 4.63065086e-09, 4.23374395e-09, 4.00630986e-09,
                  3.89889742e-09, 3.91302063e-09, 4.07317471e-09, 4.43351657e-09,
                  5.10696390e-09, 6.35415756e-09, 8.92019666e-09, 1.59621659e-08,
                  6.05700697e-08, 7.56856935e-07, 4.16820849e-08, 3.70138573e-08,
                  1.14735548e-07, 1.77338641e-07, 2.06555177e-06, 1.12732431e-06,
                  1.66235131e-07, 7.35124543e-08, 5.43253825e-08, 7.39270670e-08,
                  3.45558580e-07, 1.47035676e-06, 1.02101880e-07, 3.94039346e-08,
                  2.28877539e-08, 1.59170750e-08, 1.22590793e-08, 1.02141145e-08,
                  1.05817850e-08, 1.48576602e-08, 7.28217556e-09, 6.48275337e-09,
                  6.12337554e-09, 5.97892014e-09, 6.01287127e-09, 6.23306898e-09,
                  6.67899865e-09, 7.43393992e-09, 8.66350861e-09, 1.07209824e-08,
                  1.44823122e-08, 2.27504451e-08, 4.98513911e-08, 3.60077512e-07,
                  4.08043033e-07, 1.99746639e-07, 6.75865610e-08, 1.10605077e-07,
                  3.13900150e-07, 4.43626460e-06, 1.46582841e-06, 2.38698174e-07,
                  1.07021909e-07, 8.06980694e-08, 1.22983983e-07, 1.16434151e-06,
                  5.28554753e-07, 8.76151135e-08, 3.98454482e-08, 2.47304488e-08,
                  1.79673353e-08, 1.80673688e-08, 1.54664976e-08, 9.60582238e-09,
                  7.96525314e-09, 6.87569267e-09, 6.05325445e-09, 5.40171641e-09,
                  4.87071512e-09, 4.42910142e-09, 4.05597010e-09, 3.73658236e-09,
                  3.46018403e-09])


assert np.allclose(x, x_ref), "Error in H2O-PWR2022"
assert np.allclose(y, y_ref), "Error in O2-PWR2022"
