import pyarts3 as pyarts
import numpy as np

f = np.linspace(1e9, 1500e9, 101)

atm = pyarts.arts.AtmPoint()
atm.pressure = 1e4
atm.temperature = 250
atm["H2O"] = 5e-3
atm["O2"] = 0.21
atm["N2"] = 0.781

x = pyarts.arts.predef.get_o2_tre05(f, atm)

x_ref = np.array([2.39893852e-08, 3.29641434e-08, 7.61842893e-08, 3.90065180e-07,
                  3.91278939e-04, 3.78461699e-07, 1.28525262e-07, 1.52796348e-07,
                  3.29017646e-06, 7.29548161e-08, 3.10656665e-08, 2.40595341e-08,
                  2.40595347e-08, 2.40595352e-08, 2.40595355e-08, 2.40595358e-08,
                  2.40595361e-08, 2.40595363e-08, 2.40595364e-08, 2.40595366e-08,
                  2.40595367e-08, 2.40595368e-08, 2.40595369e-08, 2.40595370e-08,
                  6.52833846e-08, 8.36156788e-08, 3.95244922e-08, 1.01345913e-07,
                  2.22349685e-06, 3.33886254e-07, 7.59000452e-08, 6.07154305e-08,
                  3.65933251e-07, 2.38350589e-07, 4.17649600e-08, 2.40595374e-08,
                  2.40595375e-08, 2.40595375e-08, 2.40595375e-08, 2.40595375e-08,
                  2.40595375e-08, 2.40595375e-08, 2.40595375e-08, 2.40595376e-08,
                  2.40595376e-08, 2.40595376e-08, 2.57457905e-08, 1.07240508e-07,
                  3.76392290e-07, 6.55366370e-08, 1.15470246e-07, 8.33559408e-07,
                  1.36284231e-06, 1.48942421e-07, 8.36733353e-08, 2.66822387e-07,
                  4.89066926e-07, 5.73706777e-08, 2.70276419e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595377e-08, 2.40595377e-08,
                  2.40595377e-08, 2.40595377e-08, 2.40595378e-08, 2.40595378e-08,
                  2.40595378e-08])

assert np.allclose(x, x_ref), "Error in O2-TRE05"
