import pyarts3 as pyarts
import numpy as np

f = np.linspace(1e9, 25e12, 101)

atm = pyarts.arts.AtmPoint()
atm.temperature = 250
atm["liquidcloud"] = 1e-3

x = pyarts.arts.predef.get_water_droplet_ell07(f, atm)

x_ref = np.array([5.72891933e-07, 2.17342194e-03, 4.38481404e-03, 6.80703802e-03,
                  8.94229642e-03, 1.07248359e-02, 1.22628065e-02, 1.36962479e-02,
                  1.51578011e-02, 1.67716880e-02, 1.86620635e-02, 2.09617341e-02,
                  2.38185974e-02, 2.73981317e-02, 3.18793350e-02, 3.74399490e-02,
                  4.42256987e-02, 5.22996646e-02, 6.15749807e-02, 7.17491450e-02,
                  8.22768804e-02, 9.24236801e-02, 1.01412612e-01, 1.08616909e-01,
                  1.13707966e-01, 1.16690696e-01, 1.17829805e-01, 1.17525961e-01,
                  1.16203305e-01, 1.14238376e-01, 1.11930430e-01, 1.09499465e-01,
                  1.07097797e-01, 1.04825616e-01, 1.02745612e-01, 1.00894869e-01,
                  9.92937666e-02, 9.79523472e-02, 9.68747063e-02, 9.60619673e-02,
                  9.55142623e-02, 9.52320404e-02, 9.52169300e-02, 9.54723106e-02,
                  9.60037003e-02, 9.68190282e-02, 9.79288369e-02, 9.93464440e-02,
                  1.01088080e-01, 1.03173005e-01, 1.05623614e-01, 1.08465515e-01,
                  1.11727571e-01, 1.15441888e-01, 1.19643730e-01, 1.24371308e-01,
                  1.29665417e-01, 1.35568858e-01, 1.42125581e-01, 1.49379466e-01,
                  1.57372662e-01, 1.66143402e-01, 1.75723190e-01, 1.86133326e-01,
                  1.97380746e-01, 2.09453231e-01, 2.22314177e-01, 2.35897248e-01,
                  2.50101411e-01, 2.64787060e-01, 2.79774069e-01, 2.94842674e-01,
                  3.09738000e-01, 3.24178718e-01, 3.37869785e-01, 3.50518536e-01,
                  3.61852632e-01, 3.71637827e-01, 3.79693275e-01, 3.85902361e-01,
                  3.90217702e-01, 3.92659951e-01, 3.93311008e-01, 3.92303044e-01,
                  3.89805131e-01, 3.86009291e-01, 3.81117493e-01, 3.75330623e-01,
                  3.68839960e-01, 3.61821239e-01, 3.54431099e-01, 3.46805500e-01,
                  3.39059647e-01, 3.31288976e-01, 3.23570805e-01, 3.15966340e-01,
                  3.08522804e-01, 3.01275529e-01, 2.94249917e-01, 2.87463205e-01,
                  2.80926017e-01])

assert np.allclose(x, x_ref), "liquidcloud-ELL07"
