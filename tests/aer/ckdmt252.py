import pyarts
import numpy as np

f = np.linspace(1e9, 300e12, 101)

x = pyarts.arts.predef.get_co2_ckdmt252(f, 1e4, 250, 400e-6)

x_ref = np.array([
    1.3683133887398645e-18, 1.1986608079016771e-14, 2.040677409128314e-13, 1.8423491780381407e-12,
    1.5892804787889607e-11, 2.433004575940884e-10, 1.9295792532297246e-07, 1.792627484152143e-06,
    3.1703054931257207e-09, 3.2009761696815817e-10, 1.6330152291477406e-10, 2.1507961203975953e-10,
    2.3303161794584335e-11, 1.685651819246739e-11, 1.521341968700436e-11, 1.7237784834816204e-11,
    2.4211223818816034e-11, 4.091918904247319e-11, 8.367175060260492e-11, 7.415491167316572e-10,
    6.895123821342925e-10, 3.4330853617144846e-09, 2.1548587236967804e-08, 1.069711793850855e-05,
    9.661470767322115e-07, 1.8202937571518058e-08, 2.2713322261146562e-09, 4.88647834236175e-10,
    1.5280222405706742e-10, 6.330478745267197e-11, 3.084543399503924e-11, 1.797453252423259e-11,
    2.288778182637685e-11, 4.643896503399177e-11, 7.575432412039788e-11, 6.5934491233475185e-09,
    1.2323770759119517e-06, 1.7976871114981827e-06, 2.0534721731192926e-09, 1.0321780268058604e-10,
    2.562935429047162e-11, 6.5936667699836596e-12, 2.5382939084746697e-12, 1.0426107843224505e-12,
    4.024096525744555e-13, 1.530099116504563e-13, 2.702136843054603e-12, 1.527930300809665e-11,
    1.4634728547208482e-09, 7.915646046375086e-10, 1.99100098751818e-08, 1.4940746364521045e-08,
    1.100953165428226e-11, 7.148940076750939e-11, 1.1100597877571472e-14, 2.7055626847381313e-15,
    2.2823175709348283e-13, 3.522370696390133e-13, 4.852384430163427e-16, 1.4032787169612323e-15,
    7.2646144234099495e-12, 3.0549940251189625e-11, 3.949914841772973e-10, 8.999915200834057e-11,
    5.0225783677531535e-12, 6.792121359097077e-11, 4.894891693884039e-15, 1.8821445659854355e-12,
    8.650170336350239e-12, 1.3148922011909635e-10, 2.4568350657398364e-10, 1.317650610068709e-13,
    1.9963961326108213e-15, 1.8117631787369697e-13, 5.811955337280248e-13, 8.463007312577793e-14,
    1.1688011026010198e-11, 1.5520483110474996e-12, 5.044380956945788e-16, 5.822670686475249e-14,
    3.389272056091418e-14, 3.1678853964330945e-12, 4.425887599941271e-11, 6.657371042303908e-11,
    1.668785549474873e-15, 1.3588772849494647e-16, 2.5612817540536915e-17, 7.054956886161223e-18,
    2.4285195574030588e-18, 9.999158162775283e-19, 5.491942708753887e-19, 6.672089530197512e-19,
    2.691319326283277e-18, 5.820530524634251e-17, 2.754280552260129e-13, 3.0300433121226943e-12,
    5.980798296478409e-13, 1.0757180161049658e-16, 4.879209482872148e-18, 8.134589161132854e-19,
    0,
])

assert np.allclose(x, x_ref), "CO2-CKDMT252"

f = np.linspace(400e12, 1000e12, 101)

x = pyarts.arts.predef.get_o2_vis_ckdmt252(f, 1e4, 250, 0.21)

x_ref = np.array([0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
                  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
                  0.00000000e+00,  1.13697807e-09,  2.19587600e-09,  1.60985165e-08,
                  9.09448572e-08,  1.11564762e-07,  3.82757424e-08,  1.21627036e-08,
                  4.23853121e-09,  3.17889841e-09,  9.06745575e-09,  6.63727699e-08,
                  1.91307545e-07,  9.60434407e-08,  2.98889657e-08,  1.20871030e-08,
                  7.75500731e-09,  7.41742962e-09,  9.51264190e-09,  2.43361444e-08,
                  1.75177090e-08,  6.33740168e-09,  3.17889841e-09,  2.11926561e-09,
                  1.05963280e-09,  1.05963280e-09,  2.11926561e-09,  1.05963280e-09,
                  2.11926561e-09,  2.78380929e-08,  1.13510095e-07,  3.94397845e-08,
                  1.06468735e-08,  3.31554952e-09,  2.11926561e-09,  2.11926561e-09,
                  3.18718333e-09,  1.06031006e-08,  5.29816402e-09,  2.11702716e-09,
                  2.11926561e-09,  2.00308665e-09,  1.05963280e-09,  1.05963280e-09,
                  1.05963280e-09,  1.05963280e-09,  0.00000000e+00,  0.00000000e+00,
                  -6.92554180e-14,  1.05963280e-09,  1.05963280e-09,  0.00000000e+00,
                  0.00000000e+00,  6.51973170e-10,  1.05963280e-09,  2.98605273e-09,
                  2.10948489e-08,  3.93769482e-08,  8.13274819e-09,  1.66009493e-09,
                  1.05963280e-09,  1.05963280e-09,  3.65005545e-09,  2.79263167e-08,
                  7.36367616e-08,  3.58593948e-08,  1.22337380e-08,  6.35779682e-09,
                  4.26644743e-09,  4.10760361e-09,  1.31384493e-08,  2.11537656e-08,
                  1.00476240e-08,  5.29816402e-09,  4.23853121e-09,  0.00000000e+00,
                  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
                  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
                  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
                  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
                  0.00000000e+00])

assert np.allclose(x, x_ref), "O2-visCKDMT252"

f = pyarts.arts.convert.kaycm2freq(np.linspace(2000, 2750, 101))

x = pyarts.arts.predef.get_n2_fun_ckdmt252(f, 1e4, 250, 0.79, 5e-3, 0.21)

x_ref = np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 6.77285356e-11,
                  7.61217516e-10, 2.12778818e-09, 4.10134702e-09, 6.65125012e-09,
                  9.79856776e-09, 1.35996680e-08, 1.82365910e-08, 2.38286740e-08,
                  3.06370026e-08, 3.89786937e-08, 4.92267359e-08, 6.18633211e-08,
                  7.73214188e-08, 9.63928222e-08, 1.19401659e-07, 1.47065395e-07,
                  1.80228074e-07, 2.20020012e-07, 2.66981009e-07, 3.19879248e-07,
                  3.78211205e-07, 4.42321651e-07, 5.08997264e-07, 5.78191739e-07,
                  6.45536463e-07, 7.08966534e-07, 7.66279230e-07, 8.15732780e-07,
                  8.60568063e-07, 9.00506085e-07, 9.52319412e-07, 1.03047250e-06,
                  1.17371078e-06, 1.42204486e-06, 1.72365733e-06, 1.95341089e-06,
                  1.91767336e-06, 1.71578136e-06, 1.45745734e-06, 1.35687291e-06,
                  1.31878841e-06, 1.31636826e-06, 1.32832009e-06, 1.35187434e-06,
                  1.35642943e-06, 1.34364426e-06, 1.30411428e-06, 1.24853065e-06,
                  1.16396370e-06, 1.06711263e-06, 9.61926280e-07, 8.56807536e-07,
                  7.48377829e-07, 6.46208403e-07, 5.49744317e-07, 4.63518868e-07,
                  3.87907392e-07, 3.23562153e-07, 2.69743367e-07, 2.24984502e-07,
                  1.88174670e-07, 1.57917140e-07, 1.32004283e-07, 1.11851975e-07,
                  9.41122982e-08, 7.96477184e-08, 6.73124219e-08, 5.74621471e-08,
                  4.82572002e-08, 4.12649231e-08, 3.48285949e-08, 2.93078574e-08,
                  2.48682316e-08, 2.06522398e-08, 1.74595735e-08, 1.39749511e-08,
                  1.16428928e-08, 9.59510993e-09, 7.86969520e-09, 6.45950546e-09,
                  4.84234626e-09, 3.49855385e-09, 2.14257070e-09, 8.68904340e-10,
                  2.06216426e-10, 6.19307537e-12, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00])

assert np.allclose(x, x_ref), "N2-CIAfunCKDMT252"

f = pyarts.arts.convert.kaycm2freq(np.linspace(1, 360, 101))

x = pyarts.arts.predef.get_n2_rot_ckdmt252(f, 1e4, 250, 0.79, 5e-3, 0.21)
x_ref = np.array([
    4.892519398826424e-08, 1.130776309157957e-07, 1.9392380357232268e-07, 2.7858617060206603e-07,
    3.6602326729796283e-07, 4.6300564804852784e-07, 5.83077354117196e-07, 7.17245752628144e-07,
    8.613235810602405e-07, 1.0259675851833575e-06, 1.219050098771158e-06, 1.4338521437282833e-06,
    1.6358219334600407e-06, 1.8683649667762055e-06, 2.1197295565347525e-06, 2.386418437309343e-06,
    2.5905501830641463e-06, 2.8331418435321233e-06, 3.0968920340488984e-06, 3.310376895527674e-06,
    3.4734430392347874e-06, 3.6495299874182623e-06, 3.868740236491134e-06, 3.948118278569504e-06,
    4.024565894727526e-06, 4.101294284934003e-06, 4.184468347217632e-06, 4.15131956480653e-06,
    4.114351491393226e-06, 4.105836109454629e-06, 4.033111881744079e-06, 3.9159902610535854e-06,
    3.787842745051122e-06, 3.703356608441169e-06, 3.537109188282746e-06, 3.361928624379331e-06,
    3.1948283435956623e-06, 3.054713378430375e-06, 2.8670032034095795e-06, 2.670568104877669e-06,
    2.5106259152876768e-06, 2.35127357339807e-06, 2.179039566781255e-06, 1.9983324226704474e-06,
    1.858535314058169e-06, 1.7137818633553595e-06, 1.568491610222677e-06, 1.4263919613094855e-06,
    1.3080695713177683e-06, 1.191354575676385e-06, 1.0761663372897972e-06, 9.721871553024482e-07,
    8.794678086413794e-07, 7.949221813931226e-07, 7.183237728192818e-07, 6.543382511526488e-07,
    5.963344287039678e-07, 5.439029443534829e-07, 4.981258593094519e-07, 4.5644714880511987e-07,
    4.184586282832995e-07, 3.8446304541899355e-07, 3.5387452086070773e-07, 3.261266058291071e-07,
    3.0130265896261164e-07, 2.804681325182146e-07, 2.6108249430781707e-07, 2.4332994197739306e-07,
    2.274113521681099e-07, 2.134146917111973e-07, 1.9917652385634878e-07, 1.8552840103565116e-07,
    1.740812307938931e-07, 1.6357478527424242e-07, 1.5348193172312567e-07, 1.4383697369121266e-07,
    1.362266163649752e-07, 1.2835275882036248e-07, 1.204931215244661e-07, 1.129862453543171e-07,
    1.0630607612074014e-07, 9.980529325550788e-08, 9.348715149769378e-08, 8.804390677109783e-08,
    8.283004694141615e-08, 7.768642944055743e-08, 7.249602918149043e-08, 6.823390250124779e-08,
    6.394959898933966e-08, 5.966934792236792e-08, 5.591077801253824e-08, 5.251216756718912e-08,
    4.919053367930639e-08, 4.57904753327178e-08, 4.2786961795207814e-08, 3.999311893635011e-08,
    3.297692519529143e-08, 5.823906513847612e-09, 0, 0,
    0,
])

assert np.allclose(x, x_ref), "N2-CIArotCKDMT252"
