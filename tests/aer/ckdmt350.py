import pyarts
import numpy as np

f = pyarts.arts.convert.kaycm2freq(np.linspace(1, 21000, 101))

atm = pyarts.arts.AtmPoint()
atm.pressure = 1e4
atm.temperature = 250
atm["H2O"] = 1e-2
atm["O2"] = 0.21
atm["N2"] = 0.79
atm["CO2"] = 400e-6

x = pyarts.arts.predef.get_self_h2o_ckdmt350(f, atm)

x_sref = np.array([8.67921718e-08, 1.51975861e-04, 2.75826947e-05, 6.70760899e-06,
                   3.09117602e-06, 1.23734118e-06, 1.21410336e-06, 1.34989880e-05,
                   3.23215209e-05, 3.05271553e-06, 3.18226757e-07, 1.12470053e-07,
                   7.54993397e-08, 6.70375388e-08, 6.62231315e-08, 2.54628199e-07,
                   3.46542892e-07, 4.57915346e-06, 3.20505243e-05, 3.00180150e-06,
                   3.26427442e-07, 9.91032532e-08, 5.37517770e-08, 3.79681769e-08,
                   1.21669482e-07, 2.03927528e-06, 1.49335514e-06, 1.09091281e-07,
                   1.31946529e-08, 4.43856463e-09, 1.68345025e-09, 2.76939667e-09,
                   2.84534549e-08, 1.96915975e-07, 1.07872434e-06, 1.34765170e-06,
                   3.62181316e-08, 8.97742908e-09, 2.96927593e-09, 1.81451706e-09,
                   6.08856772e-09, 1.50122017e-08, 1.38215097e-07, 1.74045866e-08,
                   1.77172895e-09, 2.89460556e-10, 1.19402366e-10, 1.71476051e-10,
                   4.52672293e-10, 9.30072899e-09, 3.86017845e-08, 5.38763398e-08,
                   9.43754146e-09, 2.58901501e-09, 2.36123566e-10, 7.69253849e-11,
                   1.65149032e-10, 8.21824964e-10, 5.73941605e-09, 7.48194776e-10,
                   4.39203230e-10, 2.18386255e-11, 8.12422059e-12, 1.19173033e-11,
                   9.15383361e-11, 1.22001213e-09, 5.05967920e-09, 5.59976471e-10,
                   8.78174266e-10, 7.71805226e-11, 1.11711600e-11, 5.49203396e-12,
                   4.07806843e-11, 3.87006988e-10, 7.39046574e-11, 5.05586448e-11,
                   1.18807394e-11, 1.75072141e-12, 2.52447603e-12, 2.44013063e-11,
                   4.17549917e-10, 2.74811044e-10, 2.77044555e-11, 7.44936740e-11,
                   2.82189439e-11, 2.73032720e-12, 3.30236996e-12, 4.21294238e-11,
                   4.76796738e-11, 3.58536183e-12, 4.76131635e-12, 4.03923449e-12,
                   1.19347957e-12, 1.65608585e-11, 2.18282952e-10, 6.43774333e-11,
                   0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                   0.00000000e+00])

assert np.allclose(x, x_sref), "H2O-SelfContCKDMT350"

x = pyarts.arts.predef.get_foreign_h2o_ckdmt350(f, atm)

x_fref = np.array([7.89978771e-08, 6.80275767e-04, 1.95314402e-05, 1.45112811e-06,
                   1.02850241e-07, 1.04526206e-08, 2.68649033e-07, 9.90167807e-05,
                   1.92417668e-04, 6.54725664e-06, 1.67503208e-07, 7.84449506e-09,
                   6.10338136e-10, 1.75224171e-08, 4.42900864e-08, 9.02031214e-07,
                   5.56432710e-07, 1.85229918e-05, 1.49520213e-04, 3.67592171e-06,
                   2.46717184e-07, 1.19481621e-08, 5.18735312e-09, 5.09182329e-09,
                   9.83458460e-08, 1.26515048e-05, 9.24809361e-06, 1.24625919e-07,
                   8.91542135e-09, 5.32923381e-10, 1.74649472e-10, 1.62409783e-09,
                   1.56020508e-07, 1.00712226e-06, 8.31825821e-06, 1.09871443e-05,
                   1.22219643e-07, 7.66525643e-09, 3.12902279e-10, 4.89210240e-09,
                   2.27486734e-08, 4.42824954e-08, 7.55793955e-07, 3.90702615e-08,
                   2.81844363e-09, 1.14889183e-10, 3.19743293e-11, 6.09117040e-10,
                   8.24490395e-10, 3.68830816e-08, 2.39626508e-07, 3.80622982e-07,
                   4.18516025e-08, 3.99514420e-08, 3.89027939e-10, 3.00536526e-11,
                   5.67805582e-10, 3.31767393e-09, 3.08479117e-08, 1.63366810e-09,
                   2.35486826e-09, 4.08969354e-11, 2.81502398e-12, 9.95825803e-12,
                   1.76247138e-10, 6.35495467e-09, 2.64412481e-08, 1.14098876e-09,
                   4.61401375e-09, 3.99053496e-10, 2.53501312e-11, 3.68040761e-12,
                   1.43645974e-10, 1.96417528e-09, 2.00114181e-10, 2.78015767e-10,
                   1.62955488e-10, 1.68661372e-12, 1.10636086e-12, 4.98625676e-11,
                   2.67921898e-09, 1.34408585e-09, 4.88559770e-11, 4.08513216e-10,
                   7.81924245e-11, 1.64205794e-12, 3.89499512e-12, 1.63240578e-10,
                   2.16442169e-10, 2.08880550e-12, 1.65407128e-11, 9.31729335e-12,
                   3.50497081e-13, 1.97269299e-11, 4.40619862e-10, 5.57581795e-11,
                   0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                   0.00000000e+00])

assert np.allclose(x, x_fref), "H2O-ForeignContCKDMT350"
