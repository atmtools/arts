import pyarts3 as pyarts
import numpy as np

f = np.linspace(40e12, 56e12, 101)

atm = pyarts.arts.AtmPoint()
atm.pressure = 1e4
atm.temperature = 250
atm["H2O"] = 5e-3
atm["O2"] = 0.21
atm["N2"] = 0.781

x = pyarts.arts.predef.get_o2_cia_ckdmt100(f, atm)

x_ref = np.array([0.00000000e+00, 0.00000000e+00, 1.82284991e-09, 4.42012470e-09,
                  7.02540192e-09, 9.55026048e-09, 1.18144323e-08, 1.50192892e-08,
                  1.74228996e-08, 2.04001490e-08, 2.63425640e-08, 3.37285580e-08,
                  4.08989369e-08, 4.84936442e-08, 5.63230346e-08, 6.85953712e-08,
                  8.19820088e-08, 9.61892973e-08, 1.14328736e-07, 1.37027389e-07,
                  1.60184831e-07, 1.85266154e-07, 2.16569813e-07, 2.49880411e-07,
                  2.82211402e-07, 3.19522090e-07, 3.57696473e-07, 3.93251159e-07,
                  4.31225712e-07, 4.69098531e-07, 5.07942573e-07, 5.43462994e-07,
                  5.79338549e-07, 6.13239634e-07, 6.52275429e-07, 6.96916403e-07,
                  7.50357660e-07, 8.24426686e-07, 9.32186349e-07, 1.05611596e-06,
                  1.16475377e-06, 1.23405594e-06, 1.23658973e-06, 1.17236762e-06,
                  1.07833099e-06, 9.93765398e-07, 9.37440170e-07, 9.05745582e-07,
                  8.90094399e-07, 8.81798379e-07, 8.74847427e-07, 8.67691857e-07,
                  8.52310930e-07, 8.30086237e-07, 7.96242964e-07, 7.55677227e-07,
                  7.11560478e-07, 6.60618430e-07, 6.08988945e-07, 5.50426151e-07,
                  4.94730421e-07, 4.38114517e-07, 3.87603824e-07, 3.38825861e-07,
                  2.95464111e-07, 2.54455595e-07, 2.22188642e-07, 1.93540795e-07,
                  1.68915847e-07, 1.45951825e-07, 1.25055920e-07, 1.09241269e-07,
                  9.61260372e-08, 8.35781253e-08, 7.30163014e-08, 6.46602874e-08,
                  5.76203928e-08, 5.18357485e-08, 4.61260658e-08, 4.06305479e-08,
                  3.48989565e-08, 3.09440319e-08, 2.75906580e-08, 2.35451043e-08,
                  1.91361675e-08, 1.66175791e-08, 1.45393773e-08, 1.19449897e-08,
                  1.11544961e-08, 9.97628728e-09, 8.65673724e-09, 7.35265705e-09,
                  6.04846256e-09, 4.74239158e-09, 3.43836189e-09, 2.13394224e-09,
                  7.85498085e-10, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00])

assert np.allclose(x, x_ref), "O2-CIAfunCKDMT100"

f = np.linspace(220e12, 260e12, 101)

x = pyarts.arts.predef.get_o2_v0v0_ckdmt100(f, atm)

x_ref = np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 1.32814348e-11,
                  8.66927708e-10, 9.07021089e-10, 1.13789310e-09, 1.19018714e-09,
                  1.44546984e-09, 2.09149836e-09, 2.06258370e-09, 2.76317175e-09,
                  3.62368786e-09, 4.65432623e-09, 5.57968787e-09, 7.13783240e-09,
                  8.71476929e-09, 1.09085610e-08, 1.32390781e-08, 1.69823483e-08,
                  2.14963215e-08, 2.75561809e-08, 3.58695132e-08, 4.65973974e-08,
                  6.17183917e-08, 8.07445598e-08, 1.01943740e-07, 1.31034692e-07,
                  1.67318420e-07, 1.91699761e-07, 1.93503912e-07, 1.79957467e-07,
                  1.54154687e-07, 1.26328312e-07, 1.01473851e-07, 8.37492098e-08,
                  6.99358093e-08, 5.83977672e-08, 5.04377174e-08, 4.33446409e-08,
                  3.80062017e-08, 3.39083905e-08, 3.00517046e-08, 2.64033081e-08,
                  2.36292271e-08, 2.09564898e-08, 1.83390747e-08, 1.63883510e-08,
                  1.43598907e-08, 1.25240966e-08, 1.05913592e-08, 9.22836529e-09,
                  7.92204697e-09, 6.76813624e-09, 5.55798078e-09, 4.56541537e-09,
                  3.88078299e-09, 3.05380960e-09, 2.65916301e-09, 2.36159476e-09,
                  2.11351450e-09, 1.82068185e-09, 1.27434826e-09, 9.95719002e-10,
                  8.74435470e-10, 8.94708854e-10, 9.62582454e-10, 9.64374359e-10,
                  8.29297231e-10, 6.22936610e-10, 7.07271824e-10, 4.39596227e-10,
                  7.63812256e-10, 6.44495921e-10, 9.87328719e-10, 5.01464428e-12,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00])

assert np.allclose(x, x_ref), "O2-v0v0CKDMT100"

f = pyarts.arts.convert.kaycm2freq(np.linspace(9000, 11100, 101))

x = pyarts.arts.predef.get_o2_v1v0_ckdmt100(f, atm)

x_ref = np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00, 5.09591162e-10, 6.68182572e-10, 8.86553098e-10,
                  1.19248063e-09, 1.62970676e-09, 2.26914782e-09, 3.22943106e-09,
                  4.71532628e-09, 7.08946288e-09, 1.09962891e-08, 1.75059714e-08,
                  2.78870842e-08, 4.15285629e-08, 5.13672637e-08, 4.79703434e-08,
                  4.24609876e-08, 3.74278471e-08, 2.79393746e-08, 1.92831520e-08,
                  1.35158294e-08, 9.87656977e-09, 7.50698677e-09, 5.89302964e-09,
                  4.74760971e-09, 3.90614370e-09, 3.27001132e-09, 2.77747512e-09,
                  2.38835223e-09, 2.07559082e-09, 1.82044119e-09, 1.60957566e-09,
                  1.43330998e-09, 1.28446987e-09, 1.15764878e-09, 1.04870965e-09,
                  9.54443309e-10, 8.72329381e-10, 8.00366240e-10, 7.36947938e-10,
                  6.80773934e-10, 6.30781959e-10, 5.86097496e-10, 5.45995326e-10,
                  5.09869957e-10, 4.77212671e-10, 4.47593543e-10, 4.20647240e-10,
                  3.96061717e-10, 3.73569161e-10, 3.52938671e-10, 3.33970325e-10,
                  3.16490318e-10, 3.00346976e-10, 2.85407462e-10, 2.71555033e-10,
                  2.58686757e-10, 2.46711601e-10, 2.35548815e-10, 2.25126571e-10,
                  2.15380806e-10, 2.06254235e-10, 1.97695510e-10, 1.89658494e-10,
                  1.82101644e-10, 1.74987469e-10, 1.68282065e-10, 1.61954714e-10,
                  1.55977527e-10, 1.50325143e-10, 1.44974452e-10, 1.39904365e-10,
                  1.35095604e-10, 1.30530516e-10, 1.26192917e-10, 1.22067940e-10,
                  1.18141917e-10, 1.14402257e-10, 1.10837353e-10, 1.07436485e-10,
                  1.04189742e-10, 1.01087953e-10, 9.81226165e-11, 9.52858461e-11,
                  9.25703169e-11, 8.99692182e-11, 8.74762109e-11, 8.50853887e-11,
                  8.27912432e-11, 8.05886323e-11, 7.84727511e-11, 7.64391058e-11,
                  0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                  0.00000000e+00])

assert np.allclose(x, x_ref), "O2-v1v0CKDMT100"
